---
title: "08_Robustnessanalysis"
author: "Chiara Draxler"
date: "24 1 2022"
output: html_document
---
#1. Load Data
```{r}

load("Fake_cccu_R1.RData")
load("Fake_cccu_R2.RData")
load("Fake_cccu_R3.RData")
```


#2. Load Packages
```{r}
library(lme4)
```

#Analysis of Robustness R1

##Main Analysis

###3.1 Model 1: basic model
```{r}
R1_ma_1 <- glmer(switch ~ hc + (1 + hc | CASEID), family = binomial, data = Fake_cccu_R1)

summary(R1_ma_1)

confint(R1_ma_1)

```


###3.2 Model 2: including directly with contraceptive method associated predictors
```{r}
R1_ma_2 <- glmer(switch ~ hc*contra_satis + (1 + hc | CASEID), family = binomial, data = Fake_cccu_R1)

summary(R1_ma_2)

confint(R1_ma_2)
```

###3.3 Model 3: including not directly with contraceptive method associated predictors
```{r}
R1_ma_3 <- glmer(switch ~ hc * contra_satis + hc * sexual_satisfaction + hc * sex_freq + (1 + hc | CASEID), family = binomial, data = Fake_cccu_R1)

summary(R1_ma_3)
confint(R1_ma_3)

```

##3.4 Model 4: Controlling for observed selection effects
```{r}
R1_ma_4 <- glmer(switch ~ hc * contra_satis + hc * sexual_satisfaction + hc * sex_freq ++  AGE + DEGREE_recode + POVRATE + HLTHPROB_recode + MEDPROB_recode +  GAPINS_recode + TYPEINS_recode + NKIDS_t1 +  pregnant_between_waves + had_baby_between_waves+ Avoid_recode + FEELPG_recode + rel_dur_factor + (1 + hc | CASEID), family = binomial, data = Fake_cccu_R1)

summary(R1_ma_4)
confint(R1_ma_4)
```

## Sub Analysis

##3.2 Model 2: including directly with contraceptive method associated predictors

DURATION and satisfaction!

```{r}
R1_sa_m2 <- glmer(switch ~ hc*contra_satis + hc* contra_duration +  contra_satis * contra_duration + (1 + hc | CASEID), family = binomial, data = Fake_cccu_R1)

summary(R1_sa_m2)
confint(R1_sa_m2)
```

##3.3 Model 3: including not directly with contraceptive method associated predictors
```{r}
R1_sa_m3 <- glmer(switch ~ hc * contra_satis + hc* contra_duration +  contra_satis * contra_duration + hc * sexual_satisfaction + hc * sex_freq + (1 + hc | CASEID), family = binomial, data = Fake_cccu_R1)

summary(R1_sa_m3)
confint(R1_sa_m3)

```

##3.4 Model 4: Controlling for observed selection effects
```{r}
R1_sa_m4 <- glmer(switch ~ hc * contra_satis + hc* contra_duration +  contra_satis * contra_duration + hc * sexual_satisfaction + hc * sex_freq ++  AGE + DEGREE_recode + POVRATE + HLTHPROB_recode + MEDPROB_recode +  GAPINS_recode + TYPEINS_recode + NKIDS_t1 +  pregnant_between_waves + had_baby_between_waves+ Avoid_recode + FEELPG_recode + rel_dur_factor + (1 + hc | CASEID), family = binomial, data = Fake_cccu_R1)

summary(R1_sa_m4)

confint(R1_sa_m4)
```

