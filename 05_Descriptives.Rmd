---
title: "05_descriptives"
author: "Chiara Draxler"
date: "24 1 2022"
output: html_document
---

#1. load Data
```{r}
load("cccu_MA.RData")
load("cccu_excluded.RData")
```


#2. Load Packages
```{r}
library(psych)
library(dplyr)
library(rstatix)
library(ufs)
library(Hmisc)


```



#3. Participants
##filter values for waves

```{r}
cccu_MA_t1 <- cccu_MA%>%
  filter(WAVE == "t1")

cccu_MA_t2 <- cccu_MA%>%
  filter(WAVE == "t2")

cccu_MA_t3 <- cccu_MA%>%
  filter(WAVE == "t3")

cccu_MA_t4 <- cccu_MA%>%
  filter(WAVE == "t4")

cccu_excluded_t1 <- cccu_excluded %>%
  filter(WAVE == "t1")

```
##hormonal vs. non hormonal contraception 
```{r}
table(cccu_MA_t1$hc)#IUD & non_hc should be zero bc of exclusion - yes
1032/1723

cccu_MA_t1_only_hc <- cccu_MA_t1 %>%
  filter(hc == "hc") %>%
  filter(CONDOMR != "(1) yes" | is.na(CONDOMR),
         VASECTOMY != "(1) yes" | is.na(VASECTOMY),
         WITHDRAWR != "(1) yes" | is.na(WITHDRAWR),
         NFPR != "(1) yes" | is.na(NFPR),
         SPERMR != "(1) yes" | is.na(SPERMR))

table(cccu_MA_t1_only_hc$PILL)
table(cccu_MA_t1_only_hc$PATCH)
table(cccu_MA_t1_only_hc$RING)
table(cccu_MA_t1_only_hc$DEPO)
table(cccu_MA_t1_only_hc$IMPLANT)
table(cccu_MA_t1_only_hc$IUD)

cccu_MA_t1_combi_hc <- cccu_MA_t1 %>%
  filter(hc == "hc") %>%
  filter(CONDOMR == "(1) yes" | 
           VASECTOMY == "(1) yes" |
           WITHDRAWR == "(1) yes" |
           NFPR == "(1) yes" | 
           SPERMR == "(1) yes")

table(cccu_MA_t1_combi_hc$PILL)
table(cccu_MA_t1_combi_hc$PATCH)
table(cccu_MA_t1_combi_hc$RING)
table(cccu_MA_t1_combi_hc$DEPO)
table(cccu_MA_t1_combi_hc$IMPLANT)
table(cccu_MA_t1_combi_hc$IUD)


cccu_MA_t1_non_hc <- cccu_MA_t1 %>%
  filter(hc == "non_hc")

table(cccu_MA_t1_non_hc$CONDOMR)
table(cccu_MA_t1_non_hc$VASECTOMY)
table(cccu_MA_t1_non_hc$WITHDRAWR)
table(cccu_MA_t1_non_hc$NFPR)
table(cccu_MA_t1_non_hc$SPERMR)
table(cccu_MA_t1_non_hc$NOBARRIER)

```

##Age
```{r}
#as.numeric
psych::describe(cccu_MA_t1$AGE)
table(cccu_MA_t1$AGE)
```
##Ethnicity

```{r}
table(cccu_MA_t1$Ethnicity)

1169/1723
275/1723

```


##Degree
```{r}
table(cccu_MA_t1$DEGREE_recode)

597/1723
432/1723


```
##Employment Status
```{r}
table(cccu_MA_t1$Employment_status)
1078/1723
81/1723
(12+186+26+340)/1723
12/564
186/564
26/564
340/564

12+186+26+340
```


##Relationship Status & Duration

```{r}
#status
table(cccu_MA_t1$partnered)
1293/1723

table(cccu_MA_t1$rel_dur_factor)

#duration
table(cccu_MA_t1$rel_dur)

describe(cccu_MA_t1$rel_dur)

describe(cccu_MA_t1$rel_dur_years)
describe(cccu_MA_t1$rel_dur_months)
```


##Region and State
```{r}
#region
table(cccu_MA_t1$Region_recode)
548/1723
283/1723

#state
table(cccu_MA_t1$state_recode)
```



##Number of Kids
```{r}
table(cccu_MA_t1$NKIDS_t1)

936/1723
329/1723
304/1723

```


##Type of Insurance
```{r}
table(cccu_MA_t1$TYPEINS)
table(cccu_MA_t1$TYPEINS_recode)
1456/1723

```


##Income
```{r}
table(cccu_MA_t1$Income)
```

##POVRATE
```{r}
psych::describe(cccu_MA_t1$POVRATE)
table(cccu_MA_t1$POVRATE)

(2 +   3  +  1  +  4  +  3   +13 +   3 +   1 +  15  +  7 +   1 +   1  +  2+   21    +1    +1 +  12 +   1 +   7 + 4   + 2  + 11 +  11  +  7   + 1 +   5+    8  +  4 +  11  + 16  + 11 +   4  +  3 +   3 +  16 +   1  + 14   +18 + 4  +  1 +  10+    1  +  9  +  9  + 14 +   3+   13)/1723
```


#Comparision included to excluded sample 
```{r}
t1_comp_inex = rbind(cccu_MA_t1 %>% mutate(exclude = "no"),
                     cccu_excluded_t1 %>% mutate(exclude = "yes"))
table(t1_comp_inex$exclude)
```

##hc use
```{r}
chisq.test(t1_comp_inex$hc, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$hc,t1_comp_inex$exclude)
confIntV(t1_comp_inex$hc,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$hc)
691/1723
1032/1723
table(cccu_excluded_t1$hc)
1639/2911
810/2911
462/2911
```


##contraceptive satisfation
```{r}
t.test(t1_comp_inex$contra_satis ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)


t1_comp_inex %>% cohens_d(contra_satis ~ exclude, var.equal = TRUE, ci = TRUE)

psych::describe(cccu_MA_t1$contra_satis)
psych::describe(cccu_excluded_t1$contra_satis)
```


##sexual frequency
```{r}

chisq.test(t1_comp_inex$sex_freq, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$sex_freq,t1_comp_inex$exclude)
confIntV(t1_comp_inex$sex_freq,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$sex_freq)
97/1723
125/1723
760/1723
466/1723
275/1723

table(cccu_excluded_t1$sex_freq)
866/2911
168/2911
864/2911
548/2911
418/2911

```


##sexual satisfaction 
```{r}
t.test(t1_comp_inex$sexual_satisfaction ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(sexual_satisfaction ~ exclude, var.equal = TRUE, ci = TRUE)

psych::describe(cccu_MA_t1$sexual_satisfaction)
psych::describe(cccu_excluded_t1$sexual_satisfaction)

```


##Age
```{r}
t.test(t1_comp_inex$AGE ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(AGE ~ exclude, var.equal = TRUE, ci = TRUE)

psych::describe(cccu_MA_t1$AGE)
psych::describe(cccu_excluded_t1$AGE)
```


##Degree
```{r}
chisq.test(t1_comp_inex$DEGREE_recode, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$DEGREE_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$DEGREE_recode,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$DEGREE_recode)
1/1723
9/1723
7/1723
13/1723
12/1723
8/1723
15/1723
205/1723
432/1723
186/1723
597/1723
197/1723
41/1723
table(cccu_excluded_t1$DEGREE_recode)
6/2911
2/2911
14/2911
19/2911
26/2911
28/2911
33/2911
44/2911
513/2911
821/2911
321/2911
733/2911
274/2911
77/2911
```


##Poverty
```{r}
t.test(t1_comp_inex$POVRATE ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(POVRATE ~ exclude, var.equal = TRUE, ci = TRUE)

psych::describe(cccu_MA_t1$POVRATE)
psych::describe(cccu_excluded_t1$POVRATE)
```


##Health problems
```{r}
chisq.test(t1_comp_inex$HLTHPROB_recode, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$HLTHPROB_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$HLTHPROB_recode,t1_comp_inex$exclude, conf.level = 0.95)

table(cccu_MA_t1$HLTHPROB_recode)
1424/1723
299/1723
1424+299
table(cccu_excluded_t1$HLTHPROB_recode)
2128+517
2128/2645
517/2645

```


##medical problems
```{r}
chisq.test(t1_comp_inex$MEDPROB_recode, t1_comp_inex$exclude, correct=FALSE)

cramersV(t1_comp_inex$MEDPROB_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$MEDPROB_recode,t1_comp_inex$exclude, conf.level = 0.95)

table(cccu_MA_t1$MEDPROB_recode)
1579/1723
144/1723
table(cccu_excluded_t1$MEDPROB_recode)
2648/2911
263/2911
```


##gaps in insurance
```{r}
chisq.test(t1_comp_inex$GAPINS_recode, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$GAPINS_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$GAPINS_recode,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$GAPINS_recode)
1382/1723
341/1723
table(cccu_excluded_t1$GAPINS_recode)
2157/2870
713/2870
```

##insuranced?
```{r}
chisq.test(t1_comp_inex$TYPEINS_recode, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$TYPEINS_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$TYPEINS_recode,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$TYPEINS_recode)
1456/1723
267/1723
table(cccu_excluded_t1$TYPEINS_recode)
547/2843
2296/2843
```


##number of kids at t1
```{r}
chisq.test(t1_comp_inex$NKIDS_t1, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$NKIDS_t1,t1_comp_inex$exclude)
confIntV(t1_comp_inex$NKIDS_t1,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$NKIDS_t1)
936/1723
329/1723
304/1723
98/1723
56/1723
table(cccu_excluded_t1$NKIDS_t1)
1358/2896
621/2896
561/2896
252/2896
104/2896

```


##pregnant between waves
```{r}
chisq.test(t1_comp_inex$pregnant_between_waves, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$pregnant_between_waves,t1_comp_inex$exclude)
confIntV(t1_comp_inex$pregnant_between_waves,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$pregnant_between_waves)
1688/1723
35/1723
table(cccu_excluded_t1$pregnant_between_waves)
2770/2894
124/2894
```

##had baby between waves
```{r}
chisq.test(t1_comp_inex$had_baby_between_waves, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$had_baby_between_waves,t1_comp_inex$exclude)
confIntV(t1_comp_inex$had_baby_between_waves,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$had_baby_between_waves)
1688/1723
35/1723
table(cccu_excluded_t1$had_baby_between_waves)
```


##avoidance
```{r}
t.test(t1_comp_inex$Avoid_r ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(Avoid_r ~ exclude, var.equal = TRUE, ci = TRUE)


psych::describe(cccu_MA_t1$Avoid_r)
psych::describe(cccu_excluded_t1$Avoid_r)
```


##feelings about pregnancy
```{r}
t.test(t1_comp_inex$FEELPG_recode ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(FEELPG_recode ~ exclude, var.equal = TRUE, ci = TRUE)
psych::describe(cccu_MA_t1$FEELPG_recode)
psych::describe(cccu_excluded_t1$FEELPG_recode)
```


##relationship duration
```{r}

chisq.test(t1_comp_inex$rel_dur_factor, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$rel_dur_factor,t1_comp_inex$exclude)
confIntV(t1_comp_inex$rel_dur_factor,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$rel_dur_factor)
430/1723
336/1723
345/1723
320/1723
292/1723


```


#4. Descriptives of Variables
##t1
```{r}
cccu_MA_t1_descriptives <- cccu_MA_t1 %>%
  select(
    hc, switch, contra_satis, hc_dur,
    sexual_satisfaction, sex_freq,
    AGE, DEGREE_recode, POVRATE,
    HLTHPROB_recode, MEDPROB_recode,
    GAPINS_recode, TYPEINS_recode,
    NKIDS_t1, pregnant_between_waves, 
    had_baby_between_waves,
    Avoid_r, FEELPG_recode,
    rel_dur_factor)

psych::describe(cccu_MA_t1_descriptives$contra_satis)
psych::describe(cccu_MA_t1_descriptives$hc_dur)
psych::describe(cccu_MA_t1_descriptives$sexual_satisfaction)
psych::describe(cccu_MA_t1_descriptives$AGE)

psych::describe(cccu_MA_t1_descriptives$POVRATE)
psych::describe(cccu_MA_t1_descriptives$Avoid_r)


psych::describe(cccu_MA_t1_descriptives$FEELPG_recode)


table(cccu_MA_t1_descriptives$hc)
table(cccu_MA_t1_descriptives$switch)
table(cccu_MA_t1_descriptives$sex_freq)
table(cccu_MA_t1_descriptives$DEGREE_recode)
table(cccu_MA_t1_descriptives$HLTHPROB_recode)
table(cccu_MA_t1_descriptives$MEDPROB_recode)
table(cccu_MA_t1_descriptives$GAPINS_recode)
table(cccu_MA_t1_descriptives$TYPEINS_recode)
table(cccu_MA_t1_descriptives$NKIDS_t1)
table(cccu_MA_t1_descriptives$pregnant_between_waves)
table(cccu_MA_t1_descriptives$had_baby_between_waves)
table(cccu_MA_t1_descriptives$rel_dur_factor)

```
##t2
```{r}
cccu_MA_t2_descriptives <- cccu_MA_t2 %>%
  select(
    hc, switch, contra_satis, hc_dur,
    sexual_satisfaction, sex_freq,
    AGE, DEGREE_recode, POVRATE,
    HLTHPROB_recode, MEDPROB_recode,
    GAPINS_recode, TYPEINS_recode,
    NKIDS_t1, pregnant_between_waves, 
    had_baby_between_waves,
    Avoid_r, FEELPG_recode,
    rel_dur_factor)
colnames(cccu_MA_t2_descriptives)

psych::describe(cccu_MA_t2_descriptives$contra_satis)
psych::describe(cccu_MA_t2_descriptives$hc_dur)
psych::describe(cccu_MA_t2_descriptives$sexual_satisfaction)
psych::describe(cccu_MA_t2_descriptives$AGE)

psych::describe(cccu_MA_t2_descriptives$POVRATE)
psych::describe(cccu_MA_t2_descriptives$Avoid_r)


psych::describe(cccu_MA_t2_descriptives$FEELPG_recode)


table(cccu_MA_t2_descriptives$hc)
table(cccu_MA_t2_descriptives$switch)
table(cccu_MA_t2_descriptives$sex_freq)
table(cccu_MA_t2_descriptives$DEGREE_recode)
table(cccu_MA_t2_descriptives$HLTHPROB_recode)
table(cccu_MA_t2_descriptives$MEDPROB_recode)
table(cccu_MA_t2_descriptives$GAPINS_recode)
table(cccu_MA_t2_descriptives$TYPEINS_recode)
table(cccu_MA_t2_descriptives$NKIDS_t1)
table(cccu_MA_t2_descriptives$pregnant_between_waves)
table(cccu_MA_t2_descriptives$had_baby_between_waves)
table(cccu_MA_t2_descriptives$rel_dur_factor)

```

##t3
```{r}
cccu_MA_t3_descriptives <- cccu_MA_t3 %>%
  select(
    hc, switch, contra_satis, hc_dur,
    sexual_satisfaction, sex_freq,
    AGE, DEGREE_recode, POVRATE,
    HLTHPROB_recode, MEDPROB_recode,
    GAPINS_recode, TYPEINS_recode,
    NKIDS_t1, pregnant_between_waves, 
    had_baby_between_waves,
    Avoid_r, FEELPG_recode,
    rel_dur_factor)

psych::describe(cccu_MA_t3_descriptives$contra_satis)
psych::describe(cccu_MA_t3_descriptives$hc_dur)
psych::describe(cccu_MA_t3_descriptives$sexual_satisfaction)
psych::describe(cccu_MA_t3_descriptives$AGE)

psych::describe(cccu_MA_t3_descriptives$POVRATE)
psych::describe(cccu_MA_t3_descriptives$Avoid_r)


psych::describe(cccu_MA_t3_descriptives$FEELPG_recode)


table(cccu_MA_t3_descriptives$hc)
table(cccu_MA_t3_descriptives$switch)
table(cccu_MA_t3_descriptives$sex_freq)
table(cccu_MA_t3_descriptives$DEGREE_recode)
table(cccu_MA_t3_descriptives$HLTHPROB_recode)
table(cccu_MA_t3_descriptives$MEDPROB_recode)
table(cccu_MA_t3_descriptives$GAPINS_recode)
table(cccu_MA_t3_descriptives$TYPEINS_recode)
table(cccu_MA_t3_descriptives$NKIDS_t1)
table(cccu_MA_t3_descriptives$pregnant_between_waves)
table(cccu_MA_t3_descriptives$had_baby_between_waves)
table(cccu_MA_t3_descriptives$rel_dur_factor)
```


#5. Correlation Matrix
```{r}
#for t1
cccu_MA_t1_correlations <- cccu_MA_t1 %>%
  select(contra_satis, hc_dur,
    sexual_satisfaction,
    AGE, POVRATE, Avoid_r, FEELPG_recode)

out <- corr.test(cccu_MA_t1_correlations)
print(out, short = FALSE)


#for t2


cccu_MA_t2_correlations <- cccu_MA_t2 %>%
  select(contra_satis, hc_dur,
    sexual_satisfaction,
    AGE, POVRATE, Avoid_r, FEELPG_recode)
out <- corr.test(cccu_MA_t2_correlations)
print(out, short = FALSE)
#t3


cccu_MA_t3_correlations <- cccu_MA_t3 %>%
  select(contra_satis, hc_dur,
    sexual_satisfaction,
    AGE, POVRATE, Avoid_r, FEELPG_recode)

out <- corr.test(cccu_MA_t3_correlations)
print(out, short = FALSE)

```



#6. Checks for normality
```{r}
#hc use
table(cccu_MA$hc)
plot(cccu_MA$hc)

#contraceptive satisfaction
hist(cccu_MA$contra_satis) #no normal distribution
qqnorm(cccu_MA$contra_satis)
qqline(cccu_MA$contra_satis)

#contraceptive duration
hist(cccu_MA$hc_dur) #no normal distribution
qqnorm(cccu_MA$hc_dur)
qqline(cccu_MA$hc_dur)
table(cccu_MA$hc_dur)


#sexual satisfaction
hist(cccu_MA$sexual_satisfaction) #no normal distribution
qqnorm(cccu_MA$sexual_satisfaction)
qqline(cccu_MA$sexual_satisfaction)

#sexual frequency
table(cccu_MA$sex_freq)
plot(cccu_MA$sex_freq)#no sex und once relativ klein

#Age
hist(cccu_MA$AGE) #nearly no normal distribution
qqnorm(cccu_MA$AGE)
qqline(cccu_MA$AGE)

#degree
table(cccu_MA$DEGREE_recode)#no education bis 12. klasse sehr klein, ebenso doctoral degree
plot(cccu_MA$DEGREE_recode)

#Povrate
hist(cccu_MA$POVRATE) #no normal distribution
qqnorm(cccu_MA$POVRATE)
qqline(cccu_MA$POVRATE)

#health problems
table(cccu_MA$HLTHPROB_recode)#yes klein
plot(cccu_MA$HLTHPROB_recode)

#medical problems
table(cccu_MA$MEDPROB_recode)#yes klein
plot(cccu_MA$MEDPROB_recode)

#gaps in insurance
table(cccu_MA$GAPINS_recode)#yes klein
plot(cccu_MA$GAPINS_recode)

#insuranced
table(cccu_MA$TYPEINS_recode)#no klein
plot(cccu_MA$TYPEINS_recode)

#nkids t1
table(cccu_MA$NKIDS_t1)# 3 und 4 oder mehr Kinder klein
plot(cccu_MA$NKIDS_t1)

#pregnant / had baby between waves
table(cccu_MA$pregnant_between_waves)#yes klein
plot(cccu_MA$pregnant_between_waves)

table(cccu_MA$had_baby_between_waves)#yes klein
plot(cccu_MA$had_baby_between_waves)

#avoidance
hist(cccu_MA$Avoid_r) #no normal distribution
qqnorm(cccu_MA$Avoid_r)
qqline(cccu_MA$Avoid_r)

#feelings about pregnancy
hist(cccu_MA$FEELPG_recode) #no normal distribution
qqnorm(cccu_MA$FEELPG_recode)
qqline(cccu_MA$FEELPG_recode)

#relationship duration
table(cccu_MA$rel_dur_factor)
plot(cccu_MA$rel_dur_factor)
```


