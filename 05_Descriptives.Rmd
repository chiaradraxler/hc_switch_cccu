---
title: "05_descriptives"
author: "Chiara Draxler"
date: "24 1 2022"
output: html_document
---

#1. load Data
```{r}
load("cccu_MA.RData")
load("cccu_excluded.RData")
```


#2. Load Packages
```{r}
library(psych)
library(dplyr)
library(rstatix)
library(ufs)
library(Hmisc)


```



#3. Participants
##filter values only for t1

```{r}
cccu_MA_t1 <- cccu_MA%>%
  filter(WAVE == "t1")

cccu_excluded_t1 <- cccu_excluded %>%
  filter(WAVE == "t1")

```
##hormonal vs. non hormonal contraception 
```{r}
table(cccu_MA_t1$hc)#IUD & non_hc should be zero bc of exclusion - yes
1032/1723

cccu_MA_t1_hc <- cccu_MA_t1 %>%
  filter(hc == "hc")
 
table(cccu_MA_t1_hc$PILL)
table(cccu_MA_t1_hc$PATCH)
table(cccu_MA_t1_hc$RING)
table(cccu_MA_t1_hc$DEPO)
table(cccu_MA_t1_hc$IMPLANT)
table(cccu_MA_t1_hc$IUD)


cccu_MA_t1_non_hc <- cccu_MA_t1 %>%
  filter(hc == "non_hc")

table(cccu_MA_t1_non_hc$CONDOMR)
table(cccu_MA_t1_non_hc$VASECTOMY)
table(cccu_MA_t1_non_hc$WITHDRAWR)
table(cccu_MA_t1_non_hc$NFPR)
table(cccu_MA_t1_non_hc$SPERMR)
table(cccu_MA_t1_non_hc$NOBARRIER)

```

##Age
```{r}
#as.numeric
psych::describe(cccu_MA_t1$AGE)
table(cccu_MA_t1$AGE)
```
##Ethnicity

```{r}
table(cccu_MA_t1$Ethnicity)

1169/1723
275/1723

```


##Degree
```{r}
table(cccu_MA_t1$DEGREE_recode)

597/1723
432/1723


```
##Employment Status
```{r}
table(cccu_MA_t1$Employment_status)
1078/1723
81/1723
(12+186+26+340)/1723
```


##Relationship Status & Duration

```{r}
#status
table(cccu_MA_t1$partnered)
1293/1723

table(cccu_MA_t1$rel_dur_factor)

#duration
table(cccu_MA_t1$rel_dur)

describe(cccu_MA_t1$rel_dur)

describe(cccu_MA_t1$rel_dur_years)
describe(cccu_MA_t1$rel_dur_months)
```


##Region and State
```{r}
#region
table(cccu_MA_t1$Region_recode)
548/1723
283/1723

#state
table(cccu_MA_t1$state_recode)
```



##Number of Kids
```{r}
table(cccu_MA_t1$NKIDS_t1)

936/1723
329/1723
304/1723

```


##Type of Insurance
```{r}
table(cccu_MA_t1$TYPEINS)
table(cccu_MA_t1$TYPEINS_recode)
1456/1723

```


##Income
```{r}
table(cccu_MA_t1$Income)
```

##POVRATE
```{r}
describe(cccu_MA_t1$POVRATE)
```


#Comparision included to excluded sample 
```{r}
t1_comp_inex = rbind(cccu_MA_t1 %>% mutate(exclude = "no"),
                     cccu_excluded_t1 %>% mutate(exclude = "yes"))
table(t1_comp_inex$exclude)
```

##hc use
```{r}
chisq.test(t1_comp_inex$hc, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$hc,t1_comp_inex$exclude)
confIntV(t1_comp_inex$hc,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$hc)
1032/1723
table(cccu_excluded_t1$hc)
810/2911
```


##contraceptive satisfation
```{r}
t.test(t1_comp_inex$contra_satis ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(contra_satis ~ exclude, var.equal = TRUE, ci = TRUE)

```


##sexual frequency
```{r}

chisq.test(t1_comp_inex$sex_freq, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$sex_freq,t1_comp_inex$exclude)
confIntV(t1_comp_inex$sex_freq,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$sex_freq)
275/1723
466/1723
97/1723
table(cccu_excluded_t1$sex_freq)
418/2911
548/2911
866/2911
```


##sexual satisfaction 
```{r}
t.test(t1_comp_inex$sexual_satisfaction ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(sexual_satisfaction ~ exclude, var.equal = TRUE, ci = TRUE)

```


##Age
```{r}
t.test(t1_comp_inex$AGE ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(AGE ~ exclude, var.equal = TRUE, ci = TRUE)
```


##Degree
```{r}
chisq.test(t1_comp_inex$DEGREE_recode, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$DEGREE_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$DEGREE_recode,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$DEGREE_recode)
table(cccu_excluded_t1$DEGREE_recode)
821/2911
733/2911
274/2911

```


##Poverty
```{r}
t.test(t1_comp_inex$POVRATE ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(POVRATE ~ exclude, var.equal = TRUE, ci = TRUE)
```


##Health problems
```{r}
chisq.test(t1_comp_inex$HLTHPROB_recode, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$HLTHPROB_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$HLTHPROB_recode,t1_comp_inex$exclude, conf.level = 0.95)

```


##medical problems
```{r}
chisq.test(t1_comp_inex$MEDPROB_recode, t1_comp_inex$exclude, correct=FALSE)

cramersV(t1_comp_inex$MEDPROB_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$MEDPROB_recode,t1_comp_inex$exclude, conf.level = 0.95)
```


##gaps in insurance
```{r}
chisq.test(t1_comp_inex$GAPINS_recode, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$GAPINS_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$GAPINS_recode,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$GAPINS_recode)
table(cccu_excluded_t1$GAPINS_recode)
```

##insuranced?
```{r}
chisq.test(t1_comp_inex$TYPEINS_recode, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$TYPEINS_recode,t1_comp_inex$exclude)
confIntV(t1_comp_inex$TYPEINS_recode,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$TYPEINS_recode)
table(cccu_excluded_t1$TYPEINS_recode)
1456/1723
2296/2911
```


##number of kids at t1
```{r}
chisq.test(t1_comp_inex$NKIDS_t1, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$NKIDS_t1,t1_comp_inex$exclude)
confIntV(t1_comp_inex$NKIDS_t1,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$NKIDS_t1)
936/1723
56/1723
304/1723
table(cccu_excluded_t1$NKIDS_t1)
1358/2911
104/2911
561/2911
```


##pregnant between waves
```{r}
chisq.test(t1_comp_inex$pregnant_between_waves, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$pregnant_between_waves,t1_comp_inex$exclude)
confIntV(t1_comp_inex$pregnant_between_waves,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$pregnant_between_waves)
35/1723
table(cccu_excluded_t1$pregnant_between_waves)
124/2911
```

##had baby between waves
```{r}
chisq.test(t1_comp_inex$had_baby_between_waves, t1_comp_inex$exclude, correct=FALSE)
cramersV(t1_comp_inex$had_baby_between_waves,t1_comp_inex$exclude)
confIntV(t1_comp_inex$had_baby_between_waves,t1_comp_inex$exclude, conf.level = 0.95)
table(cccu_MA_t1$had_baby_between_waves)
table(cccu_excluded_t1$had_baby_between_waves)
```


##avoidance
```{r}
t.test(t1_comp_inex$Avoid_r ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(Avoid_r ~ exclude, var.equal = TRUE, ci = TRUE)
```


##feelings about pregnancy
```{r}
t.test(t1_comp_inex$FEELPG_recode ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(FEELPG_recode ~ exclude, var.equal = TRUE, ci = TRUE)
```


##relationship duration
```{r}
t.test(t1_comp_inex$rel_dur ~ t1_comp_inex$exclude,
       alternative = 'two.sided',
       paired = FALSE,
       conf.level = .95)

t1_comp_inex %>% cohens_d(rel_dur ~ exclude, var.equal = TRUE, ci =TRUE)
```


#4. Descriptives of Variables
```{r}
cccu_MA_t1_descriptives <- cccu_MA_t1 %>%
  select(
    hc, contra_satis, hc_dur,
    sexual_satisfaction, sex_freq,
    AGE, DEGREE_recode, POVRATE,
    HLTHPROB_recode, MEDPROB_recode,
    GAPINS_recode, TYPEINS_recode,
    NKIDS_t1, pregnant_between_waves, 
    had_baby_between_waves,
    Avoid_r, FEELPG_recode,
    rel_dur)

describe(cccu_MA_t1_descriptives)
table(cccu_MA_t1_descriptives$hc)
table(cccu_MA_t1_descriptives$sex_freq)
table(cccu_MA_t1_descriptives$DEGREE_recode)
table(cccu_MA_t1_descriptives$HLTHPROB_recode)
table(cccu_MA_t1_descriptives$MEDPROB_recode)
table(cccu_MA_t1_descriptives$GAPINS_recode)
table(cccu_MA_t1_descriptives$TYPEINS_recode)
table(cccu_MA_t1_descriptives$NKIDS_t1)
table(cccu_MA_t1_descriptives$pregnant_between_waves)
table(cccu_MA_t1_descriptives$had_baby_between_waves)

```


#5. Correlation Matrix
```{r}
cccu_MA_t1_correlations <- cccu_MA_t1 %>%
  select(contra_satis, hc_dur,
    sexual_satisfaction,
    AGE, POVRATE, Avoid_r, FEELPG_recode,
    rel_dur)

rcorr(as.matrix(cccu_MA_t1_correlations))


```






