---
title: "08_Robustnessanalysis"
author: "Chiara Draxler"
date: "24 1 2022"
output: html_document
---
#1. Load Data
```{r}
#MA
load("cccu_R1.RData")
load("cccu_R2.RData")
load("cccu_R3.RData")

#SA
load("cccu_R1_s.RData")
load("cccu_R2_s.RData")
load("cccu_R3_s.RData")
```


#2. Load Packages
```{r}
library(lme4)
```

#Analysis of Robustness R1

##Main Analysis

###3.1 Model 1: basic model
```{r}
R1_ma_1 <- glmer(switch ~ hc + (1| CASEID), family = binomial, data = cccu_R1)

summary(R1_ma_1)

#confint(R1_ma_1)

```


###3.2 Model 2: including directly with contraceptive method associated predictors
```{r}
R1_ma_2 <- glmer(switch ~ hc*contra_satis + (1| CASEID), family = binomial, data = cccu_R1)

summary(R1_ma_2)

#confint(R1_ma_2)
```

###3.3 Model 3: including not directly with contraceptive method associated predictors
```{r}
R1_ma_3 <- glmer(switch ~ hc * contra_satis + hc * sexual_satisfaction + hc * sex_freq + (1| CASEID), family = binomial, data = cccu_R1, control=glmerControl(optimizer="bobyqa"))

summary(R1_ma_3)
#confint(R1_ma_3)

```

##3.4 Model 4: Controlling for observed selection effects
```{r}
R1_ma_4 <- glmer(switch ~ hc * contra_satis + hc * sexual_satisfaction + hc * sex_freq + hc *AGE + hc *DEGREE_recode + hc *POVRATE + hc *HLTHPROB_recode + hc *MEDPROB_recode +  hc *GAPINS_recode + hc *TYPEINS_recode + hc *NKIDS_t1 +  hc *pregnant_between_waves + hc *had_baby_between_waves+ hc *Avoid_r + hc *FEELPG_recode + hc *rel_dur_factor + (1| CASEID), family = binomial, data = cccu_R1, control=glmerControl(optimizer="bobyqa", 
                                 optCtrl=list(maxfun=2e5)))

summary(R1_ma_4)
#confint(R1_ma_4)
```

## Sub Analysis

##3.2 Model 2: including directly with contraceptive method associated predictors

DURATION and satisfaction!

```{r}
R1_sa_m2 <- glmer(switch ~ contra_satis * hc_dur + (1| CASEID), family = binomial, data = cccu_R1_s)

summary(R1_sa_m2)
#confint(R1_sa_m2)
```



#Analysis of Robustness R2

##Main Analysis

###3.1 Model 1: basic model
```{r}
R2_ma_1 <- glmer(switch ~ hc + (1| CASEID), family = binomial, data = cccu_R2)

summary(R2_ma_1)

#confint(R2_ma_1)

```


###3.2 Model 2: including directly with contraceptive method associated predictors
```{r}
R2_ma_2 <- glmer(switch ~ hc*contra_satis + (1| CASEID), family = binomial, data = cccu_R2)

summary(R2_ma_2)

#confint(R2_ma_2)
```

###3.3 Model 3: including not directly with contraceptive method associated predictors
```{r}
R2_ma_3 <- glmer(switch ~ hc * contra_satis + hc * sexual_satisfaction + hc * sex_freq + (1| CASEID), family = binomial, data = cccu_R2, control=glmerControl(optimizer="bobyqa"))

summary(R2_ma_3)
#confint(R2_ma_3)

```

##3.4 Model 4: Controlling for observed selection effects
```{r}
R2_ma_4 <- glmer(switch ~ hc * contra_satis + hc * sexual_satisfaction + hc * sex_freq + hc *AGE + hc *DEGREE_recode + hc *POVRATE + hc *HLTHPROB_recode + hc *MEDPROB_recode +  hc *GAPINS_recode + hc *TYPEINS_recode + hc *NKIDS_t1 +  hc *pregnant_between_waves + hc *had_baby_between_waves+ hc *Avoid_r + hc *FEELPG_recode + hc *rel_dur_factor + (1| CASEID), family = binomial, data = cccu_R2, control=glmerControl(optimizer="bobyqa", 
                                 optCtrl=list(maxfun=2e5)))

summary(R2_ma_4)
#confint(R2_ma_4)
```

## Sub Analysis

##3.2 Model 2: including directly with contraceptive method associated predictors

DURATION and satisfaction!

```{r}
R2_sa_m2 <- glmer(switch ~ contra_satis * hc_dur + (1| CASEID), family = binomial, data = cccu_R2_s)

summary(R2_sa_m2)
#confint(R2_sa_m2)
```


#Analysis of Robustness R3

##Main Analysis

###3.1 Model 1: basic model
```{r}
R3_ma_1 <- glmer(switch ~ hc + (1| CASEID), family = binomial, data = cccu_R3)

summary(R3_ma_1)

#confint(R3_ma_1)

```


###3.2 Model 2: including directly with contraceptive method associated predictors
```{r}
R3_ma_2 <- glmer(switch ~ hc*contra_satis + (1| CASEID), family = binomial, data = cccu_R3)

summary(R3_ma_2)

#confint(R3_ma_2)
```

###3.3 Model 3: including not directly with contraceptive method associated predictors
```{r}
R3_ma_3 <- glmer(switch ~ hc * contra_satis + hc * sexual_satisfaction + hc * sex_freq + (1| CASEID), family = binomial, data = cccu_R3, control=glmerControl(optimizer="bobyqa"))

summary(R3_ma_3)
#confint(R3_ma_3)

```

##3.4 Model 4: Controlling for observed selection effects
```{r}
R3_ma_4 <- glmer(switch ~ hc * contra_satis + hc * sexual_satisfaction + hc * sex_freq + hc *AGE + hc *DEGREE_recode + hc *POVRATE + hc *HLTHPROB_recode + hc *MEDPROB_recode +  hc *GAPINS_recode + hc *TYPEINS_recode + hc *NKIDS_t1 +  hc *pregnant_between_waves + hc *had_baby_between_waves+ hc *Avoid_r + hc *FEELPG_recode + hc *rel_dur_factor + (1| CASEID), family = binomial, data = cccu_R3, control=glmerControl(optimizer="bobyqa", 
                                 optCtrl=list(maxfun=2e5)))

summary(R3_ma_4)
#confint(R3_ma_4)
```

## Sub Analysis

##3.2 Model 2: including directly with contraceptive method associated predictors

DURATION and satisfaction!

```{r}
R3_sa_m2 <- glmer(switch ~ contra_satis * hc_dur + (1| CASEID), family = binomial, data = cccu_3_s)

summary(R3_sa_m2)
#confint(R3_sa_m2)

```

