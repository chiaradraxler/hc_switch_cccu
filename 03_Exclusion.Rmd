---
title: "03_Exclusion"
author: "Chiara Draxler"
date: "21 1 2022"
output: html_document
---

- Ausschluss von Vpn
•	-  Main Analyses:
•	- No Morning after pill
•	- No missingness in:
•	- Switch
•	- Method satisfaction
•	- Sex satisfaction
•	- Sex freq
•	- selection variables
•	sum(is.na()) > 0
•	- Duration Analyses: 
•	Hauptausschluss + only Hc-user + no missing duration
•

#1. Load Data
```{r}

load("Fake_cccu_complete1.RData")
```

#2. Load Packages

```{r}
library(dplyr)
```

#3. Main Analysis 

Create Columns that indicate if person has to be excluded for every exclusion criteria 




##3.1 No morning after pill

```{r}
#overview

table(Fake_cccu_complete1$EC_recode)

#create column that indicates if used EC

Fake_cccu_complete1 <- Fake_cccu_complete1 %>%
  mutate(exclusion_used_EC = ifelse(EC_recode == "Yes",1,0))

#overview, factorize and plot

table(Fake_cccu_complete1$exclusion_used_EC)

Fake_cccu_complete1$exclusion_used_EC<-as.factor(Fake_cccu_complete1$exclusion_used_EC)


plot(Fake_cccu_complete1$exclusion_used_EC)

```

##3.2 No missingness
in:

•	- No missingness in:
•	- Switch
•	- Method satisfaction
•	- Sex satisfaction
•	- Sex freq
•	- selection variables
•	sum(is.na()) > 0

```{r}


#create column that indicates missingness in relevant variables

#Fake_cccu_complete1 <- Fake_cccu_complete1 %>%
 # mutate(exclusion_missingness = ifelse())



```


#4. Subanalysis
 no missingness in contraceptive duration 
 
#5. Analysis of robustness


	- Robustheitsanalyse 1: 
•	Hauptausschluss + no contraception method in last 30 days + no sex in last 30 days
•	- Robustheitsanalyse 2:
•	Hauptausschluss + no contraception method in last 30 days + sex in last 30 days
	

##5.3 Analysis of robustness 3
 Used Vasectomy as contraceptive method
```{r}
#overview

table(Fake_cccu_complete1$VASECTOMY)
table(Fake_cccu_complete1$SP1VAS)
table(Fake_cccu_complete1$SP2VAS)


#create column that indicates if used Vasectomy

Fake_cccu_complete1 <- Fake_cccu_complete1 %>%
  mutate(exclusion_used_vasectomy = ifelse(VASECTOMY == "(1) Yes" |
                                             SP1VAS == "(1) Yes"|
                                             SP2VAS == "(1) Yes",1,
                                           ifelse(VASECTOMY =="(0) No"|
                                                    SP1VAS == "(0) No"|
                                                    SP2VAS == "(0) No", 0, NA)))


table(Fake_cccu_complete1$exclusion_used_vasectomy)

#factorize and plot

Fake_cccu_complete1$exclusion_used_vasectomy<-as.factor(Fake_cccu_complete1$exclusion_used_vasectomy)


plot(Fake_cccu_complete1$exclusion_used_vasectomy)

```



